<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>dg</title>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap-responsive.css" rel="stylesheet" type="text/css" />
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
  </head>
  <body>
    <div class="row-fluid side-row hidden-phone">
      <div class="span2 sidebar">
        <h1 id="logo">
          <a href="#">dg</a>
        </h1>
        <ul class="nav nav-list">
          <li><a href="#overview">Overview</a></li>
          <li><a href="#installation">Installation</a></li>
          <li class="divider"></li>
          <li><a href="#introduction">Introduction</a></li>
          <li><a href="#literals">Literals</a></li>
          <li><a href="#functions">Functions</a></li>
          <li><a href="#operators">Operators</a></li>
          <li><a href="#modules">Modules</a></li>
          <li><a href="#conditionals">Conditionals</a></li>
          <li><a href="#exceptions">Exceptions</a></li>
          <li><a href="#objects">Objects</a></li>
          <li><a href="#builtins">New built-ins</a></li>
          <li class="divider"></li>
          <li><a href="#inspired-by">Inspired by</a></li>
        </ul>
      </div>
    </div>

    <div class="row-fluid content-row">
      <div class="span2 hidden-phone"></div>
      <div class="span10 content">
        <div id="overview"     class="section"><p><a href="https://github.com/pyos/dg">dg</a>
is a <del>simple-as-in-LISP</del> functional/object-oriented language that compiles to
<a href="http://python.org/">CPython</a> <a href="http://docs.python.org/dev/library/dis.html">bytecode</a>.</p><div class="highlight"><pre><span class="n">hello</span> <span class="o">=</span> <span class="nb">print</span> <span class="o">&lt;-</span> <span class="s">&#39;Hello, {}!&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">hello</span> <span class="s">&#39;dg&#39;</span>
</pre></div>
<p>Since it runs on the same VM, it can fully interoperate with any Python 3
code, from simple modules to stuff full of magic. dg code itself can be imported,
too; just make sure you load the compiler first:</p><div class="highlight"><pre><span class="c1"># my_module.dg</span>
<span class="n">flask</span> <span class="o">=</span> <span class="kr">import</span><span class="o">!</span>

<span class="n">app</span>   <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="kt">Flask</span> <span class="n">__name__</span>
<span class="n">hello</span> <span class="o">=</span> <span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">route</span> <span class="s">&#39;/&#39;</span><span class="p">)</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="s">&#39;Hello World!&#39;</span>

<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="o">!</span> <span class="ow">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span>
</pre></div>
<div class="highlight"><pre><span class="c"># __main__.py</span>
<span class="kn">import</span> <span class="nn">dg</span>
<span class="kn">import</span> <span class="nn">my_module</span>

<span class="n">my_module</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<p>Unlike Python, dg does not attempt to be an "interpreted pseudocode";
instead, it follows the "learn more, do less" principle.</p></div>
        <div id="installation" class="section"><h2>Installation</h2><p>Since dg is a Python 3 module, barely any installation is required.
Simply <a href="https://github.com/pyos/dg/zipball/master">download the compiler</a>
(or fetch it using git: <code>git clone https://github.com/pyos/dg.git</code>) and extract
the archive in a directory somewhere in your <code>$PYTHONPATH</code>
(e.g. <code>/usr/lib/python3.2/site-packages/</code>).</p><p>After installing, simply run dg as a module (i.e. with <code>-m</code>):</p><div class="highlight"><pre>python3 <span class="o">[</span>VM options<span class="o">]</span> -m dg  <span class="c"># starts the REPL</span>
python3 <span class="o">[</span>VM options<span class="o">]</span> -m dg file.dg <span class="o">[</span>arguments<span class="o">]</span>  <span class="c"># executes a file as a script</span>
python3 <span class="o">[</span>VM options<span class="o">]</span> -m dg &lt;&lt;&lt; <span class="s2">&quot;some code&quot;</span>  <span class="c"># this is a bash-specific syntax, called a &quot;herestring&quot;</span>
</pre></div>
</div>
        <div id="introduction" class="section"><h2>Tutorial</h2><h3>Parentheses and indentation</h3><p>mean the same thing: they explicitly define the precedence of operators.</p><div class="highlight"><pre><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span>

<span class="c1"># The following expressions are identical.</span>
<span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
<span class="n">a</span> <span class="o">*</span>
  <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
<p>To find out whether you need to use parentheses, see
<a href="#operator-table">the operator precedence table</a> below.</p><p>The indentation, however, has one more effect.
Aside from grouping expressions on the right side of an operator,
it also serves as a line continuation. When used straight after a function call
(or a function name), each line of the indented block is a separate argument.</p><div class="highlight"><pre><span class="nb">print</span> <span class="n">a</span> <span class="n">b</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;;&#39;</span>
<span class="nb">print</span>
  <span class="n">a</span>
  <span class="n">b</span>
  <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;;&#39;</span>
</pre></div>
<p>Unlike Python, an empty pair of parentheses (<code>()</code>, that is) evaluates to
<code>None</code>, not an empty tuple, and should be used as an empty placeholder block.</p><p>Note that dg doesn't require you to use parentheses when calling
functions, nor does it support that at all. The contents of the parentheses
will be treated as if that was an object:</p><div class="highlight"><pre><span class="nb">print</span><span class="p">()</span>  <span class="c1"># print None</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># print 1</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">bit_length</span><span class="o">!</span> <span class="c1"># print (1.bit_length!)</span>
</pre></div>
<h3>Comments</h3><div class="highlight"><pre><span class="c1"># are sh-style up to the end of the line</span>
</pre></div>
<p>There are no docstrings in dg. In fact, there aren't any in Python, too;
paradoxically, these facts together mean that you <em>can</em> use them:</p><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="p">()</span> <span class="o">-&gt;</span>
  <span class="s">&#39;&#39;&#39;</span>
<span class="s">    I hear you asking &quot;WTF?&quot;</span>
<span class="s">    In Python, &quot;docstring&quot; is simply the first constant used in a function...</span>

<span class="s">    ...if it&#39;s a string. `None` otherwise.</span>

<span class="s">  &#39;&#39;&#39;</span>
  <span class="c1"># Unless the next line is present, calling `f` will return its docstring.</span>
  <span class="bp">None</span>
</pre></div>
<p>By the way, creating strings that aren't used anywhere is another,
though not recommended, way of writing comments.</p><h3>Assignment</h3><p>is done the usual way. Where's the catch?</p><ol><li>no <code>global</code> keyword — don't change global variables from inside functions. "It would work faster that way" is not an excuse.</li><li>no <code>nonlocal</code> keyword — if a variable is created in a closure, it's <code>nonlocal</code> by default.</li></ol><div class="highlight"><pre><span class="n">my_type</span>   <span class="o">=</span> <span class="kr">inherit</span> <span class="nb">object</span> <span class="p">()</span>
<span class="n">my_dict</span>   <span class="o">=</span> <span class="nb">dict</span><span class="o">!</span>
<span class="n">my_object</span> <span class="o">=</span> <span class="n">my_type</span><span class="o">!</span>

<span class="n">my_variable</span> <span class="o">=</span> <span class="s">&#39;oh hi&#39;</span>
<span class="n">my_dict</span> <span class="o">!!</span> <span class="s">&#39;my_key&#39;</span> <span class="o">=</span> <span class="s">&#39;my_dict[&quot;my_key&quot;] = ...&#39;</span>
<span class="n">my_object</span><span class="o">.</span><span class="n">my_attribute</span> <span class="o">=</span> <span class="mi">12345</span>

<span class="n">the</span><span class="o">,</span> <span class="o">*</span><span class="n">world</span><span class="o">,</span> <span class="p">(</span><span class="n">is_</span><span class="o">,</span> <span class="n">mine</span><span class="p">)</span> <span class="o">=</span> <span class="s">&#39;but&#39;</span><span class="o">,</span> <span class="s">&#39;&quot;is&quot;&#39;</span><span class="o">,</span> <span class="s">&#39;is&#39;</span><span class="o">,</span> <span class="s">&#39;a&#39;</span><span class="o">,</span> <span class="p">(</span><span class="s">&#39;reserved&#39;</span><span class="o">,</span> <span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="n">the</span>   <span class="o">==</span> <span class="s">&#39;but&#39;</span>
<span class="n">world</span> <span class="o">==</span> <span class="nb">list&#39;</span> <span class="s">&#39;&quot;is&quot;&#39;</span> <span class="s">&#39;is&#39;</span> <span class="s">&#39;a&#39;</span>
<span class="n">is_</span>   <span class="o">==</span> <span class="s">&#39;reserved&#39;</span>
<span class="n">mine</span>  <span class="o">==</span> <span class="s">&#39;name&#39;</span>
</pre></div>
<h3>Referential transparency, laziness, and other buzzwords.</h3><p>There aren't any of these in dg. As in pure Python, the code is as side effect
free as you write it, and all expressions are evaluated eagerly.</p><p>But there <em>is</em> one trendy feature: everything is an expression! That means
it is possible to create multi-line anonymous functions (aka "lambdas"),
anonymous classes, and even catch exceptions while calling a function.
(That doesn't mean that everything returns a value that makes sense, though.)</p></div>
        <div id="literals"     class="section"><h2>Literals</h2><p>Compile-time constants:</p><div class="highlight"><pre><span class="mi">42</span>                      <span class="c1"># `int` (of arbitrary length)</span>
<span class="m-Bin">0b01010111</span>              <span class="c1"># `int` (in base 2)</span>
<span class="mo">0o755</span>                   <span class="c1"># `int` (in base 8)</span>
<span class="mh">0xDEADF00D</span>              <span class="c1"># `int` (in base 16; may be lowercase, too)</span>
<span class="mf">3.14159265358979323865</span>  <span class="c1"># `float`</span>
<span class="mf">6.959500E+9</span>             <span class="c1"># `float` (in scientific notation)</span>
<span class="mi">1j</span>                      <span class="c1"># Imaginary number (of type `complex`)</span>

<span class="s">&#39;A string!&#39;</span>
<span class="s">&quot;It may be double-quoted, too.&quot;</span>
<span class="s">&#39;Any of these</span>
<span class="s">can have line breaks in them, as well as</span><span class="se">\n</span><span class="s"> escapes and Unicode characters ☺&#39;</span>

<span class="s">r&#39;raw strings preserve </span><span class="se">\b</span><span class="s">ackslashes, but do not support escapes&#39;</span>
<span class="s">b&#39;binary strings represent non-string data, and can only contain ASCII&#39;</span>
<span class="s">rb&#39;guess what raw binary strings do&#39;</span>

<span class="s">&#39;&#39;&#39;More quotes is always better.&#39;&#39;&#39;</span>
<span class="s">&quot;&quot;&quot;Am I right?&quot;&quot;&quot;</span>
</pre></div>
<p>Runtime constants:</p><div class="highlight"><pre><span class="bp">True</span>   <span class="c1"># Tautology</span>
<span class="bp">False</span>  <span class="c1"># Contradiction</span>
<span class="bp">None</span>   <span class="c1"># The only instance of the unit type, NoneType</span>
</pre></div>
<p>Tuples are ordered immutable collections:</p><div class="highlight"><pre><span class="mi">2</span><span class="o">,</span> <span class="bp">True</span><span class="o">,</span> <span class="s">&#39;this tuple contains random stuff&#39;</span>
</pre></div>
<p>Empty tuple does not have a special syntax.</p><div class="highlight"><pre><span class="nb">tuple</span><span class="o">!</span> <span class="c1"># this one is empty</span>
</pre></div>
<p>Note that using <code>tuple'</code> is the only way to create
a singleton tuple. Why would you want to do that? Use lists.</p><div class="highlight"><pre><span class="nb">tuple&#39;</span> <span class="s">&quot;Fine, have your singleton.&quot;</span>
</pre></div>
<p>There is no special syntax for lists, either. Call <code>list</code> to make a list
out of another collection, or <code>list'</code> to create one from distinct elements:</p><div class="highlight"><pre><span class="nb">list</span>  <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">list&#39;</span>  <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>
</pre></div>
<p>Same thing applies to sets...</p><div class="highlight"><pre><span class="nb">set</span>  <span class="s">&#39;abcdabc&#39;</span>
<span class="nb">set&#39;</span> <span class="s">&#39;a&#39;</span> <span class="s">&#39;d&#39;</span> <span class="s">&#39;c&#39;</span> <span class="s">b&#39;</span>
</pre></div>
<p>...and dictionaries, aka hashmaps. The latter require an iterable of <em>pairs</em>,
(i.e. 2-tuples,) though.</p><div class="highlight"><pre><span class="nb">dict</span> <span class="o">$</span> <span class="nb">list&#39;</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="o">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="o">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">dict&#39;</span>        <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="o">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="o">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>There's a shorthand notation for dictionaries with identifier keys:</p><div class="highlight"><pre><span class="nb">dict</span>  <span class="n">a</span><span class="o">:</span> <span class="mi">1</span> <span class="n">b</span><span class="o">:</span> <span class="mi">2</span>
<span class="nb">dict&#39;</span> <span class="n">a</span><span class="o">:</span> <span class="mi">1</span> <span class="n">b</span><span class="o">:</span> <span class="mi">2</span>
</pre></div>
<p>And don't forget about line continuation:</p><div class="highlight"><pre><span class="nb">dict&#39;</span>
  <span class="s">&#39;a&#39;</span><span class="o">,</span> <span class="mi">1</span>
  <span class="s">&#39;b&#39;</span><span class="o">,</span> <span class="mi">2</span>
</pre></div>
</div>
        <div id="functions"    class="section"><h2>Functions</h2><h3>Calling them...</h3><p>The syntax for calling functions is a mix of ones found in Haskell and
Smalltalk. There are no parentheses around arguments, neither are there
commas in between them.</p><div class="highlight"><pre><span class="c1"># Here `sep` and `end` are *keyword argument names*.</span>
<span class="c1"># The order of these keyword arguments may be arbitrary;</span>
<span class="c1"># they may even come before positional ones. The only requirement</span>
<span class="c1"># is that none of them &quot;collides&quot; with a positional argument.</span>
<span class="nb">print</span> <span class="s">&#39;Hello&#39;</span> <span class="s">&#39;print&#39;</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;, &#39;</span> <span class="n">end</span><span class="o">:</span> <span class="s">&#39;!</span><span class="se">\n</span><span class="s">&#39;</span>
</pre></div>
<p>If the last argument is a call to another function, <code>$</code> will work
as a large parenthesis lasting up to the next comma, assignment, or
conditional:</p><div class="highlight"><pre><span class="nb">print</span> <span class="o">$</span> <span class="s">&#39;* {}&#39;</span><span class="o">.</span><span class="n">format</span> <span class="s">&#39;Take out the trash&#39;</span>
<span class="nb">print</span> <span class="o">$</span> <span class="s">&#39;* {}&#39;</span><span class="o">.</span><span class="n">format</span> <span class="s">&#39;Clean the kitchen&#39;</span> <span class="ow">if</span> <span class="kr">not</span> <span class="n">kitchen</span><span class="o">.</span><span class="n">clean</span>
</pre></div>
<p>Obviously, simply typing <code>print</code> won't call it (instead, it would yield the
function object itself.) To call a function with no arguments, add
an exclamation mark after its name:</p><div class="highlight"><pre><span class="nb">print</span><span class="o">!</span>
</pre></div>
<p>Avoid creating too much functions without arguments — these are a sign of a
poor design full of magic and/or (possibly undesired) side effects.
When a function doesn't modify the state, but uses it, it's better to use
<a href="http://docs.python.org/dev/library/functions.html#property">properties</a>:</p><div class="highlight"><pre><span class="kt">MyType</span> <span class="o">=</span> <span class="kr">inherit</span> <span class="nb">object</span> <span class="o">$</span>
  <span class="n">state</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="n">stateful_function</span> <span class="o">=</span> <span class="nb">property</span> <span class="o">$</span> <span class="bp">self</span> <span class="o">-&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
<p>Two keyword argument names, <code>*</code> and <code>**</code>, are special.
Whatever is passed as <code>*</code> is interpreted as a collection of the remaining
positional arguments. <code>**</code> is similar, but takes a dictionary of keyword
arguments instead:</p><div class="highlight"><pre><span class="nb">print</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;;&#39;</span> <span class="n">end</span><span class="o">:</span> <span class="s">&#39;.</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="n">items</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span>
<span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;;&#39;</span> <span class="n">end</span><span class="o">:</span> <span class="s">&#39;.</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="nb">print</span> <span class="n">items</span> <span class="o">**:</span> <span class="n">options</span>
</pre></div>
<h3>...and creating new ones.</h3><p>Functions are defined with the <code>-&gt;</code> operator. Argument specifications
are similar to those when calling functions, but with a few changes and more
strict:</p><ul><li>anything that can be assigned to is accepted as an argument name;</li><li><code>a: b</code> defines an argument <code>a</code> with a default value <code>b</code>;</li><li>if an argument before <code>*: a</code> has a default value, all arguments up to the <code>*: a</code> (or the end of the argument list) must have default values, too;</li><li>any argument after <code>*: a</code> <em>can't</em> be passed as a positional argument, only a keyword one;</li><li><code>**: a</code>, if defined, should be the last argument.</li></ul><div class="highlight"><pre><span class="n">double</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">double</span> <span class="mi">10</span> <span class="c1">#=&gt; 20</span>

<span class="c1"># These have no arguments and always return None.</span>
<span class="n">constant</span>  <span class="o">=</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span>
<span class="n">constant&#39;</span> <span class="o">=</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span>

<span class="c1"># This one accepts any amount of arguments.</span>
<span class="n">doubleMany</span> <span class="o">=</span> <span class="p">(</span><span class="o">*:</span> <span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">map</span> <span class="n">double</span> <span class="n">xs</span>
<span class="n">doubleMany</span><span class="o">!</span>      <span class="c1">#=&gt; empty `map` object</span>
<span class="n">doubleMany</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="c1">#=&gt; `map` object containing 2, 4, and 6</span>

<span class="c1"># This one requires one argument and will accept more.</span>
<span class="n">map_over_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">function</span> <span class="o">*:</span> <span class="n">xs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">map</span> <span class="n">function</span> <span class="n">xs</span>
<span class="n">map_over_args</span> <span class="n">double</span>       <span class="c1">#=&gt; empty `map` object</span>
<span class="n">map_over_args</span> <span class="n">double</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="c1">#=&gt; `map` object containing 2, 4, and 6</span>

<span class="c1"># This one has one argument with a default value.</span>
<span class="n">greet</span> <span class="o">=</span> <span class="p">(</span><span class="n">whom</span><span class="o">:</span> <span class="s">&#39;World&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">print</span> <span class="s">&#39;Hello&#39;</span> <span class="n">whom</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;, &#39;</span> <span class="n">end</span><span class="o">:</span> <span class="s">&#39;!</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="n">greet</span><span class="o">!</span>         <span class="c1">#=&gt; &#39;Hello, World!&#39;</span>
<span class="n">greet</span> <span class="s">&#39;Reader&#39;</span> <span class="c1">#=&gt; &#39;Hello, Reader!&#39;</span>

<span class="c1"># This one returns its keyword arguments.</span>
<span class="n">dict&#39;&#39;</span> <span class="o">=</span> <span class="p">(</span><span class="o">**:</span> <span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">kwargs</span>

<span class="c1"># And this one unpacks a tuple when called.</span>
<span class="c1"># Simulating Python syntax &#39;n&#39; stuff.</span>
<span class="n">lol_parentheses</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">lol_parentheses</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>Functions return the last value they evaluate unless explicitly
told to do otherwise by adding a semicolon to an expression:</p><div class="highlight"><pre><span class="n">doubleIf</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">;</span> <span class="ow">if</span> <span class="n">f</span> <span class="n">x</span>
  <span class="n">x</span>

<span class="n">doubleIf</span> <span class="p">(</span><span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="mi">10</span>  <span class="c1">#=&gt; 20</span>
<span class="n">doubleIf</span> <span class="p">(</span><span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>  <span class="mi">3</span>  <span class="c1">#=&gt;  3</span>
</pre></div>
<p>The <code>-&gt;</code> operator always consumes exactly one object to the left;
that way it is possible to create anonymous functions in the middle of
an expression without using parentheses in some cases:</p><div class="highlight"><pre><span class="nb">list</span> <span class="o">$</span> <span class="nb">map</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">bit_length</span><span class="o">!</span> <span class="o">$</span> <span class="nb">list&#39;</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="c1">#=&gt; 1, 2, 2</span>
<span class="nb">list</span> <span class="o">$</span> <span class="nb">map</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">int</span> <span class="n">x</span> <span class="mi">16</span><span class="p">)</span> <span class="s">&#39;1639F16BA&#39;</span> <span class="c1">#=&gt; 1, 6, 3, 9, 15, 1, 6, 11, 10</span>
</pre></div>
<p>Thanks to these awesome anonymous functions, there's little need for decorators
anymore. Simply pass functions to other functions:</p><div class="highlight"><pre><span class="n">wtf</span> <span class="o">=</span> <span class="nb">staticmethod</span> <span class="p">()</span> <span class="o">-&gt;</span>
  <span class="nb">print</span> <span class="s">&#39;A static method outside of a class?!&#39;</span>
</pre></div>
<p>And, of course, <a href="http://docs.python.org/py3k/reference/simple_stmts.html#the-yield-statement">yield</a>
turns a function into a coroutine (or a <a href="http://docs.python.org/dev/glossary.html#term-generator">generator</a>.)
<code>yield</code> is a function of two arguments, <code>item</code> and <code>from</code>. Only one of them may
be specified at a time. (Well, not really, but using both arguments at the same
time is probably not standardized in Python.)</p><p>Note that <code>from</code> requires Python 3.3 or newer. Also, returning some value
other than <code>None</code> from a generator in earlier versions will yield that
value; if you care about backward compatibility, make sure to end all
generators with <code>None</code>.</p><div class="highlight"><pre><span class="n">count</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-&gt;</span>
  <span class="kr">yield</span> <span class="n">start</span>
  <span class="kr">yield</span> <span class="n">from</span><span class="o">:</span> <span class="p">(</span><span class="n">count</span> <span class="o">$</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="bp">None</span>
</pre></div>
</div>

        <div id="operators" class="section">

          <h2>Operators</h2><p>Time for an implementation detail; function call is actually an operator.</p><div class="highlight"><pre><span class="n">doubleIf</span> <span class="p">(</span><span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">2</span>
<span class="c1">#       ^------^--- it&#39;s right here</span>

<span class="n">doubleIf</span> <span class="p">(</span><span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">x</span><span class="o">:</span> <span class="mi">2</span>
<span class="c1">#                ^-- another one, this time a colon</span>
</pre></div>
<p>The "colon operator" is preferred over all others, excluding the dot.
"Empty operator" comes close, but still has lower priority.</p><div class="highlight"><pre><span class="mi">3</span> <span class="o">+</span>  <span class="n">doubleIf</span>  <span class="n">x</span><span class="o">:</span> <span class="mi">2</span>  <span class="p">(</span><span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">doubleIf</span> <span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="o">==</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
<p>Most of the operators don't require great detail. The only ones not found
in Python are:</p><div class="highlight"><pre><span class="c1"># op    #=&gt; `Python equivalent`</span>
<span class="n">a</span><span class="o">!</span>      <span class="c1">#=&gt; `a()`</span>
<span class="o">!</span><span class="n">a</span>      <span class="c1">#=&gt; `not a` (not recommended, use `not` instead)</span>
<span class="n">a</span><span class="o">!.</span><span class="n">b</span>    <span class="c1">#=&gt; `a().b`</span>
<span class="n">a</span><span class="o">.~</span><span class="n">b</span>    <span class="c1">#=&gt; `del a.b`</span>
<span class="n">a</span> <span class="o">!!</span> <span class="n">b</span>  <span class="c1">#=&gt; `a[b]`</span>
<span class="n">a</span> <span class="o">!!=</span> <span class="n">b</span> <span class="c1">#=&gt; `a = a[b]`</span>
<span class="n">a</span> <span class="o">!!~</span> <span class="n">b</span> <span class="c1">#=&gt; `del a[b]`</span>
</pre></div>
<p>Any function which is defined in the local/global scope can be used
as an operator; simply wrap its name in backticks, like in Haskell:</p><div class="highlight"><pre><span class="mi">1</span> <span class="o">`max`</span> <span class="mi">5</span> <span class="c1">#=&gt; 5</span>
<span class="mi">10</span> <span class="o">`divmod`</span> <span class="mi">3</span> <span class="c1">#=&gt; (3, 1)</span>
</pre></div>
<p>Operators marked as "available at runtime" are <a href="http://en.wikipedia.org/wiki/First-class_function">first-class</a>;
most of these are imported from the <a href="http://docs.python.org/dev/library/operator.html">operator</a>
module.</p><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span>
<span class="n">f</span> <span class="mi">1</span> <span class="mi">2</span> <span class="c1">#=&gt; 3</span>
</pre></div>
<p>One special feature of first-class operators is the ability to <em>partially bind</em> them.</p><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span><span class="p">)</span>  <span class="c1"># x -&gt; 2 * x</span>
<span class="n">f</span> <span class="mi">10</span>       <span class="c1">#=&gt; 20</span>

<span class="n">g</span> <span class="o">=</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># x -&gt; x in (1..5)</span>
<span class="n">g</span>  <span class="mi">4</span>  <span class="c1">#=&gt; True</span>
<span class="n">g</span> <span class="mi">-2</span>  <span class="c1">#=&gt; False</span>
</pre></div>
<p>This partial binding is the reason why singleton tuples can't be written as <code>(a,)</code>:</p><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="p">)</span> <span class="c1"># x -&gt; (1, x)</span>
<span class="n">h</span> <span class="s">&#39;this is not a singleton!&#39;</span> <span class="c1">#=&gt; (1, &#39;this is not a singleton!&#39;)</span>
</pre></div>
<p>It is possible to define new operators if their names conform to 2 rules:</p><ul><li>it must consist of characters in <code>!$%&amp;*+-./:&lt;=&gt;?@\^|~</code> or commas (<strong>not both</strong> at the same time — <code>$,</code> is invalid;) and</li><li>it must not start with one or more asterisks followed by a colon (<code>***:!</code> is not valid, but <code>:***:!</code> is.)</li></ul><div class="highlight"><pre><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="n">y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="mi">3</span> <span class="o">&lt;&gt;</span> <span class="mi">4</span> <span class="c1">#=&gt; 5.0</span>
</pre></div>


          <h3 id="operator-table">The Complete Table of Operators</h3>
          <p>
            <a href="http://en.wikipedia.org/wiki/Order_of_operations">Priority</a>
            defines which operator takes precedence in the absence of parentheses.
            <a href="http://en.wikipedia.org/wiki/Operator_associativity">Fixity</a>
            determines how operator expressions with equal priority are parsed.
          </p>

          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>Priority</th>
                <th>Fixity</th>
                <th>?</th>
                <th>What</th>
                <th>Available in runtime</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td rowspan="2">0</td>
                <td rowspan="4">left</td>
                <td><code>.</code></td>
                <td>Attribute lookup</td>
                <td class="maybe"><code>getattr</code></td>
              </tr>

              <tr>
                <td><code>!.</code></td>
                <td>Call a function with no arguments, then fetch an attribute.</td>
                <td class="no" rowspan="2">No</td>
              </tr>

              <tr>
                <td>-2</td>
                <td><code></code></td>
                <td>(Empty operator.) Function call</td>
              </tr>

              <tr>
                <td>-3</td>
                <td><code>!!</code></td>
                <td>Array subscription (i.e. like <code>a[b]</code> in Python)</td>
                <td class="yes" rowspan="11">Yes</td>
              </tr>

              <tr>
                <td>-4</td>
                <td>right</td>
                <td><code>**</code></td>
                <td>Exponentiation</td>
              </tr>

              <tr>
                <td>-5</td>
                <td rowspan="11">left</td>
                <td>
                <code>*</code>
                  <code>/</code>
                  <code>//</code>
                  <code>%</code>
                </td>
                <td>Multiplication, division, floor division, and modulus</td>
              </tr>

              <tr>
                <td>-6</td>
                <td>
                  <code>+</code>
                  <code>-</code>
                </td>
                <td>Addition and subtraction</td>
              </tr>

              <tr>
                <td rowspan="3">-8</td>
                <td>
                  <code>&lt;</code>
                  <code>&lt;=</code>
                  <code>==</code>
                  <code>!=</code>
                  <code>&gt;=</code>
                  <code>&gt;</code>
                </td>
                <td>Standard comparison operators</td>
              </tr>

              <tr>
                <td><code>is</code></td>
                <td>Identifier-based comparison</td>
              </tr>

              <tr>
                <td><code>in</code></td>
                <td>Containment check</td>
              </tr>

              <tr>
                <td>-10</td>
                <td>
                  <code>&lt;&lt;</code>
                  <code>&gt;&gt;</code>
                </td>
                <td>Bitwise shift to the left and to the right</td>
              </tr>

              <tr>
                <td>-11</td>
                <td><code>&amp;</code></td>
                <td>Bitwise AND</td>
              </tr>

              <tr>
                <td>-12</td>
                <td><code>^</code></td>
                <td>Bitwise XOR</td>
              </tr>

              <tr>
                <td>-13</td>
                <td><code>|</code></td>
                <td>Bitwise OR</td>
              </tr>

              <tr>
                <td>-14</td>
                <td><code>and</code></td>
                <td>Lazy logical conjunction (<code>A and B</code> evaluates B iff A is true)</td>
                <td class="no" rowspan="2">No</td>
              </tr>

              <tr>
                <td>-15</td>
                <td><code>or</code></td>
                <td>Lazy logical disjunction (<code>A or B</code> evaluates B iff A is false)</td>
              </tr>

              <tr>
                <td>-16</td>
                <td>right</td>
                <td><code>$</code></td>
                <td>Function call with exactly one argument</td>
                <td class="yes">Yes</td>
              </tr>

              <tr>
                <td>-17</td>
                <td>right</td>
                <td><code>-&gt;</code></td>
                <td>Function constructor</td>
                <td class="no">No</td>
              </tr>

              <tr>
                <td>-18</td>
                <td>left</td>
                <td><code>,</code></td>
                <td>Tuple constructor</td>
                <td class="yes">Yes</td>
              </tr>

              <tr>
                <td rowspan="2">-19</td>
                <td rowspan="4">right</td>
                <td><code>=</code></td>
                <td>Assignment</td>
                <td class="no" rowspan="5">No</td>
              </tr>

              <tr>
                <td>
                  <code>!!=</code>
                  <code>+=</code>
                  <code>-=</code>
                  <code>*=</code>
                  <code>**=</code>
                  <code>/=</code>
                  <code>//=</code>
                  <code>%=</code>
                  <code>&amp;=</code>
                  <code>^=</code>
                  <code>|=</code>
                  <code>&lt;&lt;=</code>
                  <code>&gt;&gt;=</code>
                </td>
                <td><a href="http://docs.python.org/dev/reference/simple_stmts.html#augmented-assignment-statements">Augmented assignment</a></td>
              </tr>

              <tr>
                <td>-20</td>
                <td>
                  <code>if</code>
                </td>
                <td>Inline conditional branching (<code>and</code> with reversed order of operands)</td>
              </tr>

              <tr>
                <td>-21</td>
                <td><code>else</code></td>
                <td>Extension clause to the inline conditional branching</td>
              </tr>

              <tr>
                <td>-100500</td>
                <td>left</td>
                <td><code></code></td>
                <td>(Line break.) Sequential evaluation</td>
              </tr>
            </tbody>
          </table>

          <p>
            All other operators (including those defined at runtime)
            have priority -7 and left fixity. Some of these are:
          </p>

          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>?</th>
                <th>What</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td><code>.~</code></td>
                <td>Attribute removal. Returns None, can't be chained.</td>
              </tr>

              <tr>
                <td><code>!!~</code></td>
                <td>Subitem removal. Returns None, can't be chained.</td>
              </tr>

              <tr>
                <td><code>..</code></td>
                <td>Alias for <code>range</code></td>
              </tr>

              <tr>
                <td><code>::</code></td>
                <td>Alias for <code>isinstance</code></td>
              </tr>

              <tr>
                <td><code>...</code></td>
                <td>Alias for <code>Ellipsis</code>, <i>not callable</i></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div id="modules"      class="section"><h2>Modules</h2><p><em>(The current import function is not very good; it will probably be changed later.)</em></p><p><code>import</code> is an alias to <a href="http://docs.python.org/dev/library/importlib.html#importlib.import_module">importlib.import_module</a>.</p><div class="highlight"><pre><span class="n">module</span>    <span class="o">=</span> <span class="kr">import</span> <span class="s">&#39;os&#39;</span>
<span class="n">submodule</span> <span class="o">=</span> <span class="kr">import</span> <span class="s">&#39;.submodule&#39;</span> <span class="n">package</span><span class="o">:</span> <span class="n">__package__</span>
</pre></div>
<p>As a special case, when <code>import</code> is called without any arguments, dg will
attempt to infer the module name from the variable name. In that case
a variable name can be a dotted path, prefixed by any number of dots:</p><div class="highlight"><pre><span class="n">os</span>  <span class="o">=</span> <span class="kr">import</span><span class="o">!</span>
<span class="n">sys</span> <span class="o">=</span> <span class="kr">import</span><span class="o">!</span>

<span class="n">importlib</span><span class="o">.</span><span class="n">util</span> <span class="o">=</span> <span class="kr">import</span><span class="o">!</span>

<span class="o">.</span><span class="n">submodule</span> <span class="o">=</span> <span class="kr">import</span><span class="o">!</span>
</pre></div>
</div>
        <div id="conditionals" class="section"><h2>Conditionals</h2><p><code>or</code> and <code>and</code> can be treated as conditionals, in addition to being Boolean
operators. <code>a or b</code> means <code>a if a else b</code>, and <code>a and b</code> means
<code>b if a else a</code> (of course, they only evaluate <code>a</code> once.)</p><div class="highlight"><pre><span class="bp">True</span> <span class="ow">or</span>  <span class="nb">print</span> <span class="mi">1</span> <span class="c1">#=&gt; True (does not print anything)</span>
<span class="bp">True</span> <span class="ow">and</span> <span class="nb">print</span> <span class="mi">1</span> <span class="c1">#=&gt; None (also prints 1)</span>
</pre></div>
<p>"if-else" can be used in its infix form.
Note that <code>if</code> and <code>else</code> have really low priority — you will
probably want to wrap them in parentheses. "else" clause can be omitted.</p><div class="highlight"><pre><span class="s">&#39;ok&#39;</span> <span class="ow">if</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">else</span> <span class="s">&#39;wat&#39;</span> <span class="c1">#=&gt; &#39;ok&#39;</span>
</pre></div>
<p>The most powerful, and the simpliest, conditional is <code>switch</code>, which
is actually not "switch-case", but "if-else if".</p><div class="highlight"><pre><span class="n">factorial</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="kr">switch</span>
</pre></div>
<p><code>switch</code> only accepts expressions in form <code>condition = value</code> as its <em>arguments</em>
(remember to use the line continuation!) The first value assigned to a true
condition is evaluated.</p><div class="highlight"><pre>  <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">=</span> <span class="kr">raise</span> <span class="o">$</span> <span class="ne">ValueError</span> <span class="s">&#39;n &gt;= 0&#39;</span>
  <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
<p>Conditions don't have to reference the same variable; they may be completely
arbitrary. Make use of the fact that <code>True</code> is always true to do something
if everything else fails.</p><div class="highlight"><pre>  <span class="bp">True</span>  <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
        <div id="exceptions"   class="section"><h2>Exceptions</h2><p>Throw exceptions with the <code>raise</code> function. It accepts classes that derive
from BaseException as its argument, as well as their instances.</p><div class="highlight"><pre><span class="kr">raise</span> <span class="kt">Exception</span>
<span class="kr">raise</span> <span class="ne">ValueError</span>
<span class="kr">raise</span> <span class="o">$</span> <span class="ne">TypeError</span> <span class="s">&quot;something happened, I don&#39;t know what&quot;</span>
</pre></div>
<p><code>raise</code> has an optional second argument <code>caused_by</code>. When specified,
it defines the <a href="http://www.python.org/dev/peps/pep-3134/">cause</a> of the exception.
In Python 3.3, setting the cause also <a href="http://www.python.org/dev/peps/pep-0409/">silences the context</a>.</p><div class="highlight"><pre><span class="kr">raise</span> <span class="ne">AttributeError</span> <span class="n">caused_by</span><span class="o">:</span> <span class="ne">KeyError</span>
</pre></div>
<p>Exceptions can be caught with the <code>unsafe</code> function; its syntax is similar
to <code>switch</code>. The first argument is in form <code>name = expression</code>,
where <code>expression</code> is what to evaluate and <code>name</code> if where to store
the exception, if any was thrown.</p><div class="highlight"><pre><span class="kr">unsafe</span>
  <span class="n">error</span> <span class="o">=</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span> <span class="s">&#39;1234567890a&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span> <span class="s">&#39;/etc/hostname&#39;</span> <span class="s">&#39;wb&#39;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="n">i</span>
</pre></div>
<p>All other arguments are conditional expressions, just like in switch.
Any matching condition silences the exception and prevents other conditions
from evaluating. Use <code>::</code> (or <code>isinstance</code>) to check the exception's type:</p><div class="highlight"><pre>  <span class="n">error</span> <span class="o">::</span> <span class="ne">ValueError</span> <span class="o">=</span>
    <span class="nb">print</span> <span class="s">&#39;Hey, that wasn</span><span class="se">\&#39;</span><span class="s">t a decimal number!&#39;</span>
</pre></div>
<p>As in switch, conditions may be of arbitrary complexity and they are not required
to reference the exception at all.</p><div class="highlight"><pre>  <span class="n">error</span> <span class="o">::</span> <span class="p">(</span><span class="ne">OSError</span><span class="o">,</span> <span class="ne">IOError</span><span class="p">)</span> <span class="ow">and</span> <span class="n">error</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="mi">13</span> <span class="o">=</span>
    <span class="nb">print</span> <span class="s">&#39;Permission denied&#39;</span>
  <span class="n">admin_is_watching</span> <span class="o">=</span>
    <span class="c1"># Don&#39;t attract his attention with colorful tracebacks.</span>
    <span class="nb">print</span> <span class="s">&#39;Psst, user!&#39;</span> <span class="n">error</span>
</pre></div>
<p>If no exception was caught, the provided variable will be set to <code>None</code>.</p><div class="highlight"><pre>  <span class="n">error</span> <span class="ow">is</span> <span class="bp">None</span> <span class="o">=</span>
    <span class="kr">raise</span> <span class="o">$</span> <span class="ne">AssertionError</span> <span class="s">&#39;Wait, but that code was obviously incorrect!&#39;</span>
</pre></div>
<p>If the last action is assigned to <code>True</code>, rather than being treated
as a condition, it works just like <a href="http://docs.python.org/dev/reference/compound_stmts.html#finally">finally</a>
in Python. That is, it will be evaluated even if any other condition matched,
but in any case it won't silence the exception.</p><div class="highlight"><pre>  <span class="bp">True</span> <span class="o">=</span>
    <span class="nb">print</span> <span class="s">&#39;Nothing to clean up.&#39;</span>
</pre></div>
<p>As any other expression, calls to <code>unsafe</code> return a value:</p><ul><li>the value of <code>expression</code> if no exception was raised;</li><li><code>None</code> if an exception was silenced.</li></ul><p>(Obviously, it doesn't return if an exception was propagated to the caller.)</p><div class="highlight"><pre><span class="n">file</span> <span class="o">=</span> <span class="kr">unsafe</span>
  <span class="n">e</span> <span class="o">=</span> <span class="nb">open</span> <span class="s">&#39;README.md&#39;</span>
  <span class="c1"># Not having a README isn&#39;t critical, but `file` will be `None`.</span>
  <span class="n">e</span> <span class="o">::</span> <span class="ne">IOError</span> <span class="o">=</span> <span class="nb">print</span> <span class="s">&#39;Warning: no README.&#39;</span>
</pre></div>
</div>
        <div id="objects"      class="section"><h2>Objects</h2><p>Creating a type is done by calling <code>inherit</code> with class body.</p><div class="highlight"><pre><span class="kt">Animal</span> <span class="o">=</span> <span class="kr">inherit</span> <span class="o">$</span>
  <span class="n">__init__</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nb">super</span><span class="o">!.</span><span class="n">__init__</span><span class="o">!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="c1"># __init__ must always return None.</span>
    <span class="bp">None</span>

<span class="kt">Movable</span> <span class="o">=</span> <span class="kr">inherit</span> <span class="o">$</span>
  <span class="n">move</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span> <span class="n">distance</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Inches? Feet? Miles? Nah.</span>
    <span class="s">&#39;{} moved {} meters.&#39;</span><span class="o">.</span><span class="n">format</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="n">distance</span>
</pre></div>
<p><code>inherit</code> also accepts any number of base classes, as well as keyword arguments.</p><div class="highlight"><pre><span class="kt">Horse</span> <span class="o">=</span> <span class="kr">inherit</span> <span class="kt">Movable</span> <span class="kt">Animal</span> <span class="n">metaclass</span><span class="o">:</span> <span class="nb">type</span> <span class="o">$</span>
  <span class="n">gallop</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-&gt;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">move</span> <span class="mi">40</span>
</pre></div>
<p>Instantiating a class is done by calling it.</p><div class="highlight"><pre><span class="n">sam</span> <span class="o">=</span> <span class="kt">Horse</span> <span class="s">&#39;Sam&#39;</span>
<span class="n">sam</span><span class="o">.</span><span class="n">gallop</span><span class="o">!</span>
</pre></div>
</div>
        <div id="builtins"     class="section"><h2>New built-ins</h2><p>Since dg is clearly more oriented towards functional programming,
some of the combinators were moved to the built-in namespace and modified
to look more haskellish.</p><p><code>foldl</code> is almost like <code>functools.reduce</code>:</p><div class="highlight"><pre><span class="nb">sum</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="nb">foldl</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="mi">0</span> <span class="n">xs</span>
</pre></div>
<p><code>foldl1</code> is the same thing, but without a starting value:</p><div class="highlight"><pre><span class="n">lconstruct</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="nb">foldl1</span> <span class="p">(</span><span class="o">,</span><span class="p">)</span> <span class="n">xs</span>
</pre></div>
<p><code>scanl</code> and <code>scanl1</code> are similar, but also yield intermediate values.
In fact, <code>scanl</code> and <code>scanl1</code> use <code>itertools.accumulate</code>;
because of that, they won't work on Python versions older than 3.3.</p><div class="highlight"><pre><span class="n">accumulate</span> <span class="o">=</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="nb">scanl1</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="n">xs</span>
</pre></div>
<p><code>bind</code> is <code>functools.partial</code>:</p><div class="highlight"><pre><span class="n">greet</span> <span class="o">=</span> <span class="nb">bind</span> <span class="nb">print</span> <span class="s">&#39;Hello&#39;</span> <span class="n">sep</span><span class="o">:</span> <span class="s">&#39;, &#39;</span> <span class="n">end</span><span class="o">:</span> <span class="s">&#39;!</span><span class="se">\n</span><span class="s">&#39;</span>
<span class="n">greet</span> <span class="s">&#39;World&#39;</span>
</pre></div>
<p><code>flip</code> swaps the order of arguments of a binary function:</p><div class="highlight"><pre><span class="n">contains</span> <span class="o">=</span> <span class="nb">flip</span> <span class="p">(</span><span class="ow">in</span><span class="p">)</span>
<span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">)</span> <span class="o">`contains`</span> <span class="mi">3</span>
</pre></div>
<p><code>&lt;-</code> is a function composition operator:</p><div class="highlight"><pre><span class="n">dot_product</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">&lt;-</span> <span class="nb">bind</span> <span class="nb">map</span> <span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="n">dot_product</span> <span class="p">(</span><span class="nb">list&#39;</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">list&#39;</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
<p><code>takewhile</code> and <code>dropwhile</code> are imported from <code>itertools</code>:</p><div class="highlight"><pre><span class="n">until_zero</span> <span class="o">=</span> <span class="nb">bind</span> <span class="nb">takewhile</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!=</span><span class="p">)</span>
<span class="n">until_zero</span> <span class="o">$</span> <span class="nb">list&#39;</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">6</span> <span class="c1">#=&gt; 1, 2, 3, 4</span>
</pre></div>
<p><code>take</code> returns the first N items, and <code>drop</code> returns the rest:</p><div class="highlight"><pre><span class="nb">take</span> <span class="mi">5</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#=&gt; 0, 1, 2, 3, 4</span>
<span class="nb">drop</span> <span class="mi">5</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#=&gt; 5, 6, 7, 8, 9</span>
</pre></div>
<p><code>iterate</code> repeatedly applies a function to some value:</p><div class="highlight"><pre><span class="n">count</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="nb">iterate</span> <span class="p">(</span><span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">x</span>
<span class="n">count</span> <span class="mi">5</span> <span class="c1">#=&gt; 5, 6, 7, 8, ...</span>
</pre></div>
<p><code>head</code>, <code>tail</code>, <code>fst</code>, <code>snd</code>, <code>init</code>, and <code>last</code> work like their Haskell
versions, but on all iterables (except for <code>init</code> and <code>last</code> — they only work
on collections that support slicing.)</p><div class="highlight"><pre>       <span class="n">tail</span>
    <span class="o">/--------\</span>
<span class="p">[</span>0<span class="p">,</span> 1<span class="p">,</span> 2<span class="p">,</span> 3<span class="p">,</span> 4<span class="p">]</span>
 ^<span class="o">--</span> <span class="n">head</span>

    <span class="n">init</span>
 <span class="o">/--------\</span>
<span class="p">[</span>5<span class="p">,</span> 6<span class="p">,</span> 7<span class="p">,</span> 8<span class="p">,</span> 9<span class="p">]</span>
             ^<span class="o">--</span> <span class="n">last</span>

    <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
<span class="n">fst</span> <span class="o">--</span>^    ^<span class="o">--</span> <span class="n">snd</span>
</pre></div>
</div>

        <div id="inspired-by" class="section">
          <h2>Inspired by</h2>
          <ul>
            <li>Python, obviously</li>
            <li>Haskell</li>
            <li>CoffeeScript and LiveScript</li>
            <li>Smalltalk</li>
            <li>Lisp</li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
