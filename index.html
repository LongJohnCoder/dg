<!DOCTYPE html>
<html asd="qwe">
  <head>
    <meta charset="utf-8" />
    <title>dg</title>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap-responsive.css" rel="stylesheet" type="text/css" />
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
  </head>
  <body>
    <div class="row-fluid side-row hidden-phone">
      <div class="span2 sidebar">
        <h1 id="logo">
          <a href="#">dg</a>
        </h1>
        <ul class="nav nav-list">
          <li><a href="#overview">Overview</a></li>
          <li class="divider"></li>
          <li><a href="#installation">Installation</a></li>
          <li><a href="#usage">Usage</a></li>
          <li class="divider"></li>
          <li><a href="#introduction">Introduction</a></li>
          <li><a href="#literals">Literals</a></li>
          <li><a href="#functions">Functions</a></li>
          <li><a href="#operators">Operators</a></li>
          <li><a href="#modules">Modules</a></li>
          <li><a href="#conditions">Conditions</a></li>
          <li><a href="#loops">Loops</a></li>
          <li><a href="#exceptions">Exceptions</a></li>
          <li><a href="#objects">Objects</a></li>
          <li><a href="#miscellaneous">Miscellaneous</a></li>
          <li class="divider"></li>
          <li><a href="#performance">Performance</a></li>
          <li><a href="#inspired-by">Inspired by</a></li>
        </ul>
      </div>
    </div>

    <div class="row-fluid content-row">
      <div class="span2 hidden-phone"></div>
      <div class="span10 content">
        <div id="overview" class="section">
          <h2>Overview</h2>
          <p>
            dg is a (not so) simple language that compiles to CPython bytecode.
            In fact, you can think of it as of an alternative syntax for Python 3.
            The key feature of dg is the ability to use whatever Python library you want.
          </p>
        </div>

        <div id="installation" class="section">
          <h2>Installation</h2>
          <p>
            Since dg is a Python 3 module, barely any installation is required.
            Simply <a href="https://github.com/pyos/dg/zipball/master">download
            the compiler</a> (or fetch it using git:
            <code>git clone https://github.com/pyos/dg.git</code>) and extract
            the archive in a directory somewhere in your <code>$PYTHONPATH</code>
            (e.g. <code>/usr/lib/python3.2/site-packages/</code>).
            Don't forget to run <code>git submodule init</code> and
            <code>git submodule update</code>!
          </p>
        </div>

        <div id="usage" class="section">
          <h2>Usage</h2>
          <p>Usage: <code>python3 -m dg [options] [file [arguments]]</code></p>
          <p>There are no options except for <code>-h</code>/<code>--help</code> (yet.)</p>
        </div>

        <div id="introduction" class="section">
          <h2>Introduction</h2>
          <h3>Parentheses and indentation</h3>
          <p>mean the same thing: they explicitly define the precedence of operators.</p>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  <span class="str">'A function!'</span>
<span class="par">(</span><span class="par">)</span> <span class="op">-></span> <span class="par">(</span><span class="str">'Still a function!'</span><span class="par">)</span>
</pre>
          </div>
          <p>Parentheses are not required in most cases, though.</p>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="par">(</span><span class="par">)</span> <span class="op">-></span> <span class="str">'A function, too!'
</pre>
          </div>
          <p>
            Line breaks and semicolons in both parentheses and indented blocks
            separate different expressions, and indentation can be used
            inside parentheses, so it's better to be cautious when it comes
            to adding whitespace.
          </p>
          <p>
            Also, dg doesn't require you to use parentheses when <i>calling</i>
            functions. In fact, it doesn't support that at all.
            <a href="#functions">The only syntax for calls is a mix of Haskell
            and Smalltalk.</a>
          </p>
          <h3>Comments</h3>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># are sh-style up to the end of the line</span>
</pre>
          </div>
          <h3>Assignment</h3>
          <p>
            is done the usual way: <code>name = value</code>.
            The assignment can also be used to assign attributes or items, or
            unwrap iterables, almost like in Python.
          </p>
          <p>
            Everything is an expression. That doesn't mean that everything
            returns a value that makes sense, though. For example,
            <code>while</code> always returns <code>None</code> due to limitations
            of the CPython virtual machine.
          </p>
          <h3>Namespaces</h3>
          <p>
            dg does not treat neither parentheses nor indented blocks as
            separate scopes. Every assignment you do inside will affect
            the outside block as well. The only exceptions are, as always,
            functions and classes.</p>
          <p>
            You can't declare variables without assigning to them. In fact,
            there is no reason to, because you can't modify them from inner scopes.
            There is no <code>global</code> or <code>nonlocal</code> keyword —
            and I bet most people (especially those writing in functional style)
            would agree that using those is a bad practice. Note, though, that
            assigning to a variable that is defined in an outside scope
            (excluding the global namespace) is a compile-time error.
            Trust me, that can save you some headache later.
          </p>
        </div>

        <div id="literals" class="section">
          <h2>Literals</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Numbers</span>
<span class="typ">42</span>
<span class="typ">3.14159265358979323865</span>
<span class="typ">6.959500E+9</span>
<span class="typ">1j</span>
<span class="typ">0b01010111</span>
<span class="typ">0o755</span>
<span class="typ">0xDEADF00D</span>

<span class="com"># Booleans (actually Python builtins)</span>
<span class="spc">True</span>
<span class="spc">False</span>
<span class="spc">None</span>

<span class="com"># Strings</span>
<span class="str">'Single-'</span>
<span class="str">"or double-quoted (these are not recommended, though.)"</span>
<span class="str">'They all can span</span>
<span class="str">multiple lines and have</span>
<span class="str">Unicode characters in them ☺'</span>

<span class="str">r'raw strings preserve \backslashes'</span>
<span class="str">b'binary strings only contain ASCII characters'</span>
<span class="str">br'guess what raw binary strings do'</span>

<span class="str">'Instead of escaping \'s'</span>
<span class="str">'''you may use triple-quoted strings.'''</span>

<span class="com"># Tuples</span>
<span class="typ">1</span><span class="op">,</span> <span class="com"># with a single item</span>
<span class="typ">2</span><span class="op">,</span> <span class="typ">True</span><span class="op">,</span> <span class="str">'hi'</span> <span class="com"># with multiple items (and an optional comma at the end)</span>
<span class="blt">tuple</span><span class="op">:</span> <span class="com"># empty</span>

<span class="com"># Since the comma operator has the lowest priority (slightly higher than =, though), you may need to wrap it in parentheses.</span>
print<span class="op">:</span>  <span class="spc">True</span><span class="op">,</span> <span class="typ">1</span>  <span class="com"># Prints True, returns (None, 1)</span>
print<span class="op">:</span> <span class="par">(</span><span class="spc">True</span><span class="op">,</span> <span class="typ">1</span><span class="par">)</span> <span class="com"># Prints (True, 1), returns None</span>
</pre>
          </div>
        </div>

        <div id="functions" class="section">
          <h2>Functions</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Calling functions is almost like sending messages in Smalltalk.</span>
print<span class="op">:</span> <span class="str">'Hello'</span> <span class="str">'print'</span> sep<span class="op">:</span> <span class="str">', '</span> end<span class="op">:</span> <span class="str">'!\n'</span>
<span class="com"># And calling them without arguments is no different.</span>
print<span class="op">:</span>

<span class="com"># If you do have some arguments to pass, though, there's also a Haskell-ish notation.</span>
print <span class="str">'Hello, uh...Haskell?'</span> <span class="op">$</span> <span class="str">'No, totally not {}'</span><span class="op">.</span>format <span class="str">'Haskell.'</span>

<span class="com"># Due to the nature of Python, you can't partially apply functions that way.</span>
<span class="com"># Good thing the ~: operator can help you with that.</span>
<span class="com"># (`~:` means `functools.partial`, by the way. It's just an alias.)</span>
greet <span class="op">=</span> print <span class="op">~:</span> <span class="str">'Hello,'</span>
greet<span class="op">:</span> <span class="str">'World'</span>

<span class="com"># Our good friends *starred **arguments are still with us.</span>
<span class="com"># As always, * means "the rest of positional arguments" and ** is "the rest of keyword arguments."</span>
a <span class="op">=</span> <span class="typ">1</span><span class="op">,</span> <span class="typ">2</span><span class="op">,</span> <span class="typ">3</span><span class="op">,</span>
print<span class="op">:</span> <span class="par">(</span><span class="op">*</span><span class="par">)</span><span class="op">:</span> a

<span class="com"># Define functions with -> operator</span>
function <span class="op">=</span> <span class="par">(</span>x<span class="par">)</span> <span class="op">-></span> print<span class="op">:</span> <span class="str">'Yay, '</span> x

<span class="com"># You may omit parentheses if there's only one (unambiguous) argument:</span>
double <span class="op">=</span> x <span class="op">-></span> x <span class="op">*</span> 2
<span class="com"># This is invalid because `whom: 'world' -> ...` is parsed as `whom: ('world' -> ...)`.</span>
<span class="com">#greet = whom: 'world' -> (print: 'Hello,' whom end: '!\n')</span>
<span class="com"># This is also invalid, you can't do `* function`</span>
<span class="com">#f = *xs -> xs</span>

<span class="com"># Arguments can have default values.</span>
function2 <span class="op">=</span> <span class="par">(</span>x<span class="op">:</span> <span class="spc">None</span><span class="par">)</span> <span class="op">-></span> function<span class="op">:</span> x
<span class="com"># Starred arguments have a different syntax in function definitions.</span>
double_all <span class="op">=</span> <span class="par">(</span><span class="op">*</span>xs<span class="par">)</span> <span class="op">-></span> <span class="blt">map</span><span class="op">:</span> double xs

<span class="com"># The -> operator always consumes exactly one token to the left,</span>
<span class="com"># so you can wrap function body in parentheses instead of doing the same</span>
<span class="com"># for the whole function definition.</span>
double_all <span class="op">=</span> <span class="par">(</span><span class="op">*</span>xs<span class="par">)</span> <span class="op">-></span> <span class="blt">map</span><span class="op">:</span> x <span class="op">-></span> <span class="par">(</span>x <span class="op">*</span> <span class="typ">2</span><span class="par">)</span> xs

<span class="com"># There is no special syntax for decorators.</span>
<span class="com"># Just call them with the function as an argument.</span>
wtf <span class="op">=</span> <span class="blt">staticmethod</span><span class="op">:</span> <span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  print<span class="op">:</span> <span class="str">'A static method outside of a class?!'</span>

<span class="com"># Functions return the last value they evaluate, unless explicitly told to do otherwise.</span>
do_something <span class="op">=</span> <span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  <span class="typ">1</span>
  <span class="typ">2</span>
  <span class="typ">3</span>  <span class="com"># do_something will return 3</span>

<span class="com"># Remember about parentheses meaning the same thing as indentation?</span>
do_something2 <span class="op">=</span> <span class="par">(</span><span class="par">)</span> <span class="op">-></span> <span class="par">(</span><span class="typ">1</span><span class="sep">;</span> <span class="typ">2</span><span class="sep">;</span> <span class="typ">3</span><span class="par">)</span>

<span class="com"># You can even use indentation in them. (So don't insert line breaks just everywhere.)</span>
do_something3 <span class="op">=</span> <span class="par">(</span><span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  <span class="typ">1</span>
  <span class="typ">2</span>
  <span class="typ">3</span>
<span class="par">)</span>

do_something4 <span class="op">=</span> <span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  <span class="typ">1</span>
  <span class="kwd">return</span><span class="op">:</span> <span class="typ">2</span>  <span class="com"># do_something4 will return 2 and ignore everything after that line</span>
  <span class="typ">3</span>  <span class="com"># Well, the bytecode will still be generated. There's no optimizer yet.</span>

do_something5 <span class="op">=</span> <span class="par">(</span><span class="par">)</span> <span class="op">-></span>
  <span class="com"># And do_something5 is a generator.</span>
  <span class="kwd">yield</span><span class="op">:</span> <span class="typ">1</span>
  <span class="com"># That's how you handle `generator.send(...)`:</span>
  somebody_sent_something_here <span class="op">=</span> <span class="kwd">yield</span><span class="op">:</span> <span class="typ">2</span>
  <span class="kwd">yield</span><span class="op">:</span> <span class="typ">3</span>
  <span class="com"># All returned values but None also get yielded, so it's better to explicitly return None. Just in case.</span>
  <span class="spc">None</span>
</pre>
          </div>
        </div>

        <div id="operators" class="section">
          <h2>Operators</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Function calls are preferred over other operators</span>
double_all<span class="op">:</span> <span class="typ">2</span> <span class="typ">4</span> <span class="op">*</span> <span class="typ">3</span>
<span class="com"># i.e. that line is the same as</span>
<span class="par">(</span>double_all<span class="op">:</span> <span class="typ">2</span> <span class="typ">4</span><span class="par">)</span> <span class="op">*</span> <span class="typ">3</span>

<span class="com"># Attribute access is the only exception to that rule.</span>
print<span class="op">:</span> object<span class="op">.</span>__class__
print<span class="op">:</span> <span class="par">(</span>object<span class="op">.</span>__class__<span class="par">)</span>  <span class="com"># Same thing</span>

<span class="com"># Most of the operators deal with numbers.</span>
<span class="typ">1</span> <span class="op">+</span> <span class="typ">2</span> <span class="op">**</span> <span class="typ">3</span>
<span class="com"># Binary stuff:</span>
<span class="typ">6</span> <span class="op">|</span> <span class="par">(</span><span class="typ">2</span> <span class="op">&lt;&lt;</span> <span class="typ">3</span><span class="par">)</span>

<span class="com"># Unsurprisingly, subitem access is just like in Haskell.</span>
<span class="par">(</span><span class="str">'a'</span><span class="op">,</span> <span class="str">'b'</span><span class="par">)</span> <span class="op">!!</span> <span class="typ">1</span>
<span class="com"># There is no special syntax for slices yet, sorry.</span>
<span class="com"># `'abcdefghijklmnopqrstuvwxyz'[:5]` is written like this:</span>
<span class="str">'abcdefghijklmnopqrstuvwxyz'</span> <span class="op">!!</span> slice<span class="op">:</span> <span class="spc">None</span> <span class="typ">5</span>

<span class="com"># Assignment can work with names, attributes, subitems, and tuples:</span>
a <span class="op">=</span> <span class="str">'Hello'</span>
a<span class="op">.</span>b <span class="op">=</span> <span class="str">'yes'</span>
a <span class="op">!!</span> b <span class="op">=</span> <span class="str">'this is ='</span>
<span class="com"># Tuples may also contain names, attributes, subitems and tuples, as well as starred arguments:</span>
a<span class="op">,</span> <span class="op">*</span>b<span class="op">,</span> c <span class="op">=</span> <span class="typ">1</span><span class="op">,</span> <span class="typ">2</span><span class="op">,</span> <span class="typ">3</span><span class="op">,</span> <span class="typ">4</span>
print<span class="op">:</span> a b c  <span class="com"># 1 [2, 3] 4</span>

<span class="com"># Any binary function can be transformed into an operator by wrapping its name in backticks:</span>
do_stuff <span class="op">=</span> <span class="par">(</span>a<span class="op">,</span> b<span class="par">)</span> <span class="op">-></span> print<span class="op">:</span> a b
<span class="typ">1</span> <span class="iop"</span>`do_stuff`</span> <span class="typ">2</span>  <span class="com"># Prints "1 2"</span>
<span class="spc">False</span> <span class="iop"</span>`is`</span> <span class="spc">True</span>  <span class="com"># Returns False</span>

<span class="com"># Some operators have runtime versions, kindly provided by the `operator` module.</span>
dot_product = <span class="par">(</span>xs<span class="op">,</span> ys<span class="par">)</span> <span class="op">-></span> <span class="blt">sum</span> <span class="op">$</span> <span class="blt">map</span><span class="op">:</span> <span class="par">(</span><span class="op">*</span><span class="par">)</span> xs ys

<span class="com"># And you can define your own if you think these are not enough. Don't consider that a very good practice, though.</span>
<span class="par">(</span><span class="op">$%^&*/|\@!+-:.,?</span><span class="par">)</span> <span class="op">=</span> do_stuff
<span class="typ">1</span> <span class="op"</span>$%^&*/|\@!+-:.,?</span> <span class="typ">2</span>  <span class="com"># Also prints "1 2"</span>
</pre>
          </div>

          <h3>The full table of operators</h3>
          <table class="table table-bordered table-striped">
            <thead>
              <th>?</th>
              <th>What</th>
              <th>Available in runtime</th>
            </thead>
            <tr>
              <td><code></code></td>
              <td>(Empty operator.) Function call</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>:</code></td>
              <td>Function call, the right-hand statement is parsed as an argument. Calls a function with no arguments when only one argument is supplied.</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>$</code></td>
              <td>Function call, the right-hand statement is parsed as an expression. Calls a function with <code>()</code> (an empty block) when only one argument is supplied.</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>=</code></td>
              <td>Generic assignment</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>+ - * ** / // %</code></td>
              <td>Built-in Python numeric operators</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>& ^ | << >> ~</code></td>
              <td>Built-in Python binary operators</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>!!</code></td>
              <td>Subitem lookup</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>!!= += -= *= **= /= //= %= &= ^= |= <<= >>=</code></td>
              <td>Destructive in-place equivalents of the above operators</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>&lt; &lt;= == != > >=</code></td>
              <td>Built-in comparison operators</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>is</code></td>
              <td>Identifier-based comparison <b>(prefix)</b></td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>in</code></td>
              <td>Whether an object is in a container <b>(prefix)</b></td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>or and</code></td>
              <td>Built-in Python logic operators <b>(lazy, infix)</b></td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>if unless else</code></td>
              <td>Inline conditional branching <b>(lazy, infix)</b></td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>.</code></td>
              <td>Attribute lookup</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>.~</code></td>
              <td>Attribute removal. Returns None</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>!!~</code></td>
              <td>Subitem removal. Returns None</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>,</code></td>
              <td>Tuple constructor</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><code>-></code></td>
              <td>Function constructor</td>
              <td class="no">No</td>
            </tr>
            <tr>
              <td><code>~:</code></td>
              <td>Partial function application</td>
              <td class="yes">Yes</td>
            </tr>
          </table>
        </div>

        <div id="modules" class="section">
          <h2>Modules</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Import modules with `import` or `__import__`</span>
module <span class="op">=</span> <span class="kwd">import</span><span class="op">:</span> <span class="str">'os'</span>

<span class="com"># You can omit the module name if it can be inferred.</span>
<span class="com"># (Note the absence of `:`, that will be fixed later)</span>
sys <span class="op">=</span> <span class="kwd">import</span>
os<span class="op">.</span>path <span class="op">=</span> <span class="kwd">import</span>
<span class="op">.</span>relative<span class="op">.</span>import <span class="op">=</span> <span class="kwd">import</span>

<span class="com"># Not much else to show here. Star-imports will never be supported.</span>
<span class="com"># dg modules don't work, 'cause there's no import hook yet.</span>
</pre>
          </div>
        </div>

        <div id="conditions" class="section">
          <h2>Conditions</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Basic stuff like `or` and `and` is available.</span>
<span class="spc">True</span> <span class="op">or</span> <span class="spc">False</span>  <span class="com"># `a or b` is the same as `a if a else b`</span>
<span class="typ">2</span> <span class="op">and</span> <span class="str">'HA'</span>  <span class="com"># `a and b` is the same as `b if a else a`</span>

<span class="com"># `not` is a function,</span>
<span class="blt">not</span><span class="op">:</span> <span class="str">'an operator'</span>

<span class="com"># if/else can only be used in its infix form</span>
print<span class="op">:</span> <span class="par">(</span><span class="str">'expected'</span> <span class="op">if</span> <span class="spc">True</span> <span class="op">else</span> <span class="str">'wtf'</span><span class="par">)</span>

<span class="com"># `unless` means `if not`.</span>
<span class="com"># Both `if` and `unless` have lower priority than assignment,</span>
<span class="com"># so don't forget about parentheses</span>
always_assigned_to <span class="op">=</span> <span class="par">(</span><span class="str">'expected'</span> <span class="op">unless</span> <span class="spc">False</span> <span class="op">else</span> <span class="str">'wtf'</span><span class="par">)</span>
<span class="com"># `else` clauses can be omitted, in which case `if` and `unless`</span>
<span class="com"># work like `and` and `or` with reversed order of arguments, respectively.</span>
<span class="com"># This can be useful to evaluate single statements conditionally.</span>
never_assigned_to <span class="op">=</span> <span class="typ">2</span> <span class="op">unless</span> <span class="spc">True</span>

factorial <span class="op">=</span> n <span class="op">-></span>
  <span class="com"># The most powerful (and the simpliest, actually)</span>
  <span class="com"># conditional is `switch`.</span>
  <span class="kwd">switch</span><span class="op">:</span>
    <span class="com"># Switch only accepts expressions in form `condition = action`.</span>
    n <span class="op">&lt;</span> <span class="typ">0</span> <span class="op">=</span> <span class="kwd">raise</span> <span class="op">$</span> <span class="exc">ValueError</span></span class="op">:</span> <span class="str">'n >= 0'</span>
    <span class="com"># It evaluates the first action to be assigned to a true condition.</span>
    n <span class="op">&lt;</span> <span class="typ">2</span> <span class="op">=</span> <span class="typ">1</span>
    <span class="com"># Conditions may be completely unrelated to each other.</span>
    <span class="blt">not</span> <span class="op">$</span> factorial <span class="iop">`is`</span> factorial <span class="op">=</span> <span class="kwd">raise</span> <span class="op">$</span> <span class="exc">SanityError</span><span class="op">:</span> <span class="str">'wat'</span>
    <span class="com"># It's not considered an error if nothing matched, but None will be returned.</span>
    <span class="com"># If you need a default action, though, simply assign something to `1` or `True`.</span>
    <span class="spc">True</span> <span class="op">=</span> n <span class="op">*</span> factorial<span class="op">:</span> <span class="par">(</span>n <span class="op">-</span> <span class="typ">1</span><span class="par">)</span>
</pre>
          </div>
        </div>

        <div id="loops" class="section">
          <h2>Loops</h2>
        </div>

        <div id="exceptions" class="section">
          <h2>Exceptions</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Raise exceptions with the `raise` built-in.</span>
<span class="kwd">raise</span><span class="op">:</span> <span class="exc">Exception</span>

<span class="com"># Raise accepts classes that derive from BaseException</span>
<span class="com"># as well as their instances.</span>
<span class="kwd">raise</span> <span class="op">$</span> <span class="exc">Exception</span><span class="op">:</span> <span class="str">'Ow!'</span>
<span class="kwd">raise</span><span class="op">:</span> <span class="par">(</span><span class="exc">OblivionError</span><span class="op">:</span> <span class="str">'Stop right there, criminal scum'</span><span class="par">)</span>

<span class="com"># Catch thrown exceptions with the `unsafe` conditional.</span>
<span class="com"># Its syntax is similar to `switch`.</span>
<span class="kwd">unsafe</span><span class="op">:</span>
  <span class="com"># The first expression is in form `name = expression`,</span>
  <span class="com"># where `expression` is what you want to do</span>
  <span class="com"># and `name` is where to store the raised exception, if any.</span>
  error <span class="op">=</span>
    i <span class="op">=</span> <span class="blt">int</span><span class="op">:</span> <span class="str">'1234567890a'</span>
    f <span class="op">=</span> <span class="blt">open</span><span class="op">:</span> <span class="str">'/etc/hostname'</span> <span class="str">'wb'</span>
    f<span class="op">.</span>write<span class="op">:</span> i
  <span class="com"># All other lines are conditional expressions.</span>
  <span class="com"># Use `isinstance` to match exception types:</span>
  error <span class="iop">`isinstance`</span> <span class="exc">ValueError</span> <span class="op">=</span>
    print<span class="op">:</span> <span class="str">'Hey, that wasn\'t a decimal number!'</span>
  <span class="com"># You may also check the exception's attributes if you want:</span>
  error <span class="iop">`isinstance`</span> <span class="exc">IOError</span> <span class="op">and</span> error<span class="op">.</span>errno <span class="op">==</span> <span class="typ">13</span> <span class="op">=</span>
    print<span class="op">:</span> <span class="str">'Permission denied'</span>
  <span class="com"># As in `switch`, conditions may be completely unrelated.</span>
  <span class="com"># Any matching condition will silence the exception.</span>
  admin_is_watching <span class="op">=</span>
    <span class="com"># Don't attract his attention with colorful tracebacks.</span>
    print<span class="op">:</span> <span class="str">'Psst, user!'</span> error
  <span class="com"># If no exception was caught, the provided variable will be set to None.</span>
  error <span class="iop">`is`</span> <span class="spc">None</span> <span class="op">=</span>
    <span class="kwd">raise</span> <span class="op">$</span> <span class="exc">AssertionError</span><span class="op">:</span> <span class="str">'Wait, but that code was obviously incorrect!'</span>
  <span class="com"># If the last action is assigned to True, it has a special meaning.</span>
  <span class="com"># Specifically, it will be called regardless of whether any</span>
  <span class="com"># any other condition matched (and whether there was any</span>
  <span class="com"># exception at all.) It won't silence the exception, though.</span>
  <span class="spc">True</span> <span class="op">=</span>
    print<span class="op">:</span> <span class="str">'That is, it is the same as `finally` in Python.'</span>

<span class="com"># One more thing to note. `unsafe` returns:</span>
<span class="com">#   * the value of the unsafe expression if no exception was raised;</span>
<span class="com">#   * None if an exception was raised, but handled;</span>
<span class="com">#   * nothing if there was an unhandled exception.</span>
file <span class="op">=</span> <span class="kwd">unsafe</span><span class="op">:</span>
  e <span class="op">=</span> <span class="blt">open</span><span class="op">:</span> <span class="str">'README.md'</span>
  <span class="com"># Not having a README isn't critical, but `file` will be `None`.</span>
  e <span class="iop">`isinstance`</span> <span class="exc">IOError</span> <span class="op">=</span> <span class="par">(</span><span class="par">)</span>
</pre>
          </div>
        </div>

        <div id="objects" class="section">
          <h2>Objects</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># Creating a type is done by calling `inherit` with the class body.</span>
<span class="cls">MyType</span> <span class="op">=</span> <span class="kwd">inherit</span> <span class="op">$</span>
  a <span class="op">=</span> <span class="typ">1</span>

MyType<span class="op">.</span>a <span class="op">==</span> <span class="typ">1</span>

<span class="com"># `inherit` also accepts any amount of base classes.</span>
<span class="cls">MyList</span> <span class="op">=</span> <span class="kwd">inherit</span><span class="op">:</span> <span class="cls">MyType</span> <span class="blt">list</span> <span class="op">$</span>
  b <span class="op">=</span> <span class="typ">2</span>

MyList<span class="op">.</span>a <span class="op">==</span> <span class="typ">1</span>
MyList<span class="op">.</span>b <span class="op">==</span> <span class="typ">2</span>

<span class="com"># The syntax for calling functions applies to `inherit`, too.</span>
<span class="cls">MyTypeWithMetaclass</span> <span class="op">=</span> <span class="kwd">inherit</span><span class="op">:</span> <span class="par">(</span><span class="op">*</span><span class="par">)</span><span class="op">:</span> bases_list metaclass<span class="op">:</span> <span class="cls">MyMetaclass</span> <span class="par">(</span><span class="par">)</span>

<span class="cls">Animal</span> <span class="op">=</span> <span class="kwd">inherit</span> <span class="op">$</span>
  <span class="com"># Classes can have methods, which are actually functions.</span>
  __init__ <span class="op">=</span> <span class="par">(</span><span class="spc">self</span><span class="op">,</span> name<span class="par">)</span> <span class="op">-></span>
    <span class="com"># One of the most awful syntactic constructs</span>
    <span class="com"># (just a runtime function call, actually)</span>
    <span class="com"># is a call to one of the superclasses' methods:</span>
    <span class="par">(</span><span class="blt">super</span><span class="op">:</span><span class="par">)</span><span class="op">.</span>__init__<span class="op">:</span>  <span class="com"># See <a href="http://docs.python.org/dev/library/functions.html#super">Python docs</a> for details</span>

    <span class="spc">self</span><span class="op">.</span>name <span class="op">=</span> name
    <span class="com"># __init__ must always return None.</span>
    <span class="com"># This is one of the pointless limitations of CPython.</span>
    <span class="spc">None</span>

  eat <span class="op">=</span> <span class="par">(</span><span class="spc">self</span><span class="par">)</span> <span class="op">-></span>
    print<span class="op">:</span> <span class="str">'OM NOM NOM'</span>

<span class="com"># Instantiating a class is done by calling it, as always.</span>
bob <span class="op">=</span> <span class="cls">Animal</span><span class="op">:</span> <span class="str">'Bob'</span>
bob<span class="op">.</span>eat<span class="op">:</span>
</pre>
          </div>
        </div>

        <div id="miscellaneous" class="section">
          <h2>Miscellaneous</h2>
          <div class="example-dg">
            <pre class="prettyprint lang-dg">
<span class="com"># No matter what BDFL says, `reduce` is pretty useful.</span>
<span class="com"># So it's back as `foldl`:</span>
<span class="blt">sum</span> <span class="op">=</span> xs <span class="op">-></span> <span class="blt">foldl</span><span class="op">:</span> <span class="par">(</span><span class="op">+</span><span class="op">)</span> xs <span class="typ">0</span>
</pre>
          </div>
        </div>

        <div id="performance" class="section">
          <h2>Performance</h2>
          <p>
            dg should be on par with Python 3 in terms of evaluation speed.
            But the compilation stage is...pretty slow. It takes nearly 150ms
            to set up the Python interpreter, load the compiler and parse
            <a href="https://gist.github.com/3068335">a real-world 169 LOC file</a>
            on my computer.
          </p>
          <p>
            To be exact, dg-generated bytecode may or may not be slower than Python 3 —
            that depends on how good your code is. CPython has a simple bytecode
            optimizer which eliminates some of the dead code, combines some
            opcodes, preloads <code>True</code>/<code>False</code>/<code>None</code>
            at the compilation stage and does other kinds of stuff, while dg lacks such
            an optimizer. That shouldn't be a problem most of the time, though.
          </p>
        </div>

        <div id="inspired-by" class="section">
          <h2>Inspired by</h2>
          <ul>
            <li>Python, obviously</li>
            <li>Haskell</li>
            <li>CoffeeScript and LiveScript</li>
            <li>Smalltalk</li>
            <li>Lisp</li>
        </div>

        <div id="thanks" class="section">
          <h2>Thanks</h2>
          <p>
            Thanks to me. <span style="color: white">And /pr/.</span>
            Special thanks to Python developers who, as always,
            <a href="http://docs.python.org/dev/whatsnew/3.3.html">do implement cool features</a>,
            but release them 2 or 3 months after I want to try them out. :-)
          </p>
      </div>
    </div>
  </body>
</html>

